<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Explore Destinations · Cameroon Explore</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="css/style.css" />
  <meta name="theme-color" content="#0b1020" />
</head>
<body>
  <script type="module">
    import { CM, loadData } from './js/shared.js';
    CM.renderShell('explore');
  </script>
  
<div class="container">
  <h1>Explore Cameroon</h1>
  <div class="toolbar">
    <input id="q" class="input" placeholder="Search region or culture (festival, cuisine…)" />
    <select id="regionSel"><option value="">All regions</option></select>
    <select id="cultureSel">
      <option value="">All culture types</option>
      <option value="festivals">Festivals</option>
      <option value="cuisines">Cuisines</option>
      <option value="crafts">Crafts</option>
      <option value="music">Music</option>
    </select>
  </div>
  <div id="grid" class="grid cols-3"></div>
</div>
<script type="module">
  import { CM, loadData } from './js/shared.js';
  const { destinations } = await loadData();
  const regionSel = document.getElementById('regionSel');
  destinations.forEach(d=> regionSel.insertAdjacentHTML('beforeend', `<option value="${d.id}">${d.name}</option>`));
  const grid = document.getElementById('grid');
  function render(){
    const rq = (document.getElementById('q').value||'').toLowerCase();
    const rsel = regionSel.value;
    const csel = document.getElementById('cultureSel').value;
    grid.innerHTML='';
    destinations.filter(d=>{
      if(rsel && d.id!==rsel) return false;
      if(rq && !(d.name.toLowerCase().includes(rq) || Object.values(d.highlights).some(arr=>arr.join(',').toLowerCase().includes(rq)))) return false;
      if(csel && !(d.highlights[csel] && d.highlights[csel].length)) return false;
      return true;
    }).forEach(d=>{
      const badge = csel ? (d.highlights[csel][0]||'Cultural item') : (Object.values(d.highlights)[0][0]||'Culture');
      grid.insertAdjacentHTML('beforeend', `
        <a href="destination.html?id=${d.id}" class="card">
          <img class="resp" src="${d.image}" alt="${d.name}"/>
          <div class="content">
            <h3>${d.name}</h3>
            <div class="tags"><span class="tag">${badge}</span></div>
            <div class="kicker">${d.intro}</div>
          </div>
        </a>`);
    });
    if(!grid.children.length){
      grid.innerHTML = `<div class="empty">No destinations match your filters.</div>`;
    }
  }
  ['q','regionSel','cultureSel'].forEach(id=>document.getElementById(id).addEventListener('input', render));
  render();
</script>

</body>
</html>
